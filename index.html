<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>重庆市第66中学校2025级1班毕业纪念</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* 基础样式 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', 'PingFang SC', sans-serif;
        }

        body {
            min-height: 100vh;
            color: #333;
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            overflow-x: hidden;
            padding: 20px;
            position: relative;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding-top: 80px;
        }

        /* 主题切换按钮 */
        .theme-switch {
            position: fixed;
            top: 85px;
            right: 20px;
            z-index: 100;
        }

        .theme-switch button {
            background: rgba(255, 255, 255, 0.8);
            color: #1a2a6c;
            border: none;
            border-radius: 30px;
            padding: 10px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            font-weight: 500;
            z-index: 1000;
        }

        .theme-switch button:hover {
            background: #ffd700;
            color: #1a2a6c;
            transform: translateY(-2px);
        }

        /* 导航栏 */
        .navbar {
            background: rgba(26, 42, 108, 0.9);
            backdrop-filter: blur(10px);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.2);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-brand {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.4rem;
            font-weight: bold;
            color: #ffd700;
        }

        .nav-brand i {
            font-size: 1.8rem;
        }

        .nav-links {
            display: flex;
            gap: 25px;
        }

        .nav-links a {
            color: #fff;
            text-decoration: none;
            font-size: 1.1rem;
            transition: color 0.3s;
            position: relative;
            padding: 5px 0;
        }

        .nav-links a.active, 
        .nav-links a:hover {
            color: #ffd700;
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: #ffd700;
            transition: width 0.3s;
        }

        .nav-links a:hover::after,
        .nav-links a.active::after {
            width: 100%;
        }

        .nav-toggle {
            display: none;
            background: none;
            border: none;
            color: #fff;
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* 毛玻璃效果容器 */
        .glass-container {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            padding: 30px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        /* 头部样式 */
        header {
            text-align: center;
            padding: 40px 20px;
            position: relative;
            margin-top: 20px;
        }

        .school-logo {
            width: 120px;
            height: 120px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 50px;
            color: #fff;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
        }

        h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            background: linear-gradient(to right, #ffd700, #ffffff, #ffd700);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            letter-spacing: 2px;
        }

        .subtitle {
            font-size: 1.6rem;
            margin-bottom: 20px;
            color: #e0e0ff;
        }

        .class-info {
            font-size: 1.3rem;
            color: #ffd700;
            margin-top: 10px;
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        /* 视频播放器区域 */
        .video-section {
            margin: 40px 0;
            text-align: center;
        }

        .video-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
        }

        video {
            width: 100%;
            display: block;
            max-height: 450px;
        }

        /* 照片墙 */
        .gallery-section {
            margin: 50px 0;
        }

        .section-title {
            text-align: center;
            font-size: 2.3rem;
            margin-bottom: 30px;
            color: #ffd700;
            position: relative;
        }

        .section-title::after {
            content: '';
            display: block;
            width: 100px;
            height: 4px;
            background: linear-gradient(to right, transparent, #ffd700, transparent);
            margin: 10px auto;
        }

        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .photo-item {
            border-radius: 15px;
            overflow: hidden;
            height: 250px;
            position: relative;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease;
            background: rgba(0, 0, 0, 0.2);
        }

        .photo-item:hover {
            transform: translateY(-10px) scale(1.03);
            z-index: 2;
        }

        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .photo-item:hover img {
            transform: scale(1.1);
        }

        .photo-item::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40%;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.7), transparent);
        }

        .photo-caption {
            position: absolute;
            bottom: 15px;
            left: 15px;
            color: white;
            font-weight: bold;
            z-index: 1;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
        }

        /* 班级通讯录 */
        .roster-section {
            margin: 50px 0;
        }

        .roster-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .student-card {
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(5px);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            align-items: center;
            transition: transform 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .student-card.male {
            border-left: 4px solid #3498db;
        }

        .student-card.female {
            border-left: 4px solid #e84393;
        }

        .student-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.18);
        }

        .student-avatar {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: rgba(255, 215, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-right: 15px;
            flex-shrink: 0;
            color: #fff;
        }

        .student-info {
            flex-grow: 1;
        }

        .student-name {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 5px;
            color: #ffd700;
        }

        .student-contact {
            display: flex;
            align-items: center;
            margin-top: 8px;
            font-size: 0.95rem;
        }

        .student-contact i {
            width: 20px;
            color: #ffd700;
            margin-right: 8px;
        }

        /* 时间线 */
        .timeline-section {
            margin: 50px 0;
        }

        .timeline {
            position: relative;
            max-width: 800px;
            margin: 0 auto;
        }

        .timeline::before {
            content: '';
            position: absolute;
            top: 0;
            bottom: 0;
            width: 4px;
            background: rgba(255, 215, 0, 0.6);
            left: 50%;
            margin-left: -2px;
        }

        .timeline-item {
            position: relative;
            margin-bottom: 50px;
            width: 100%;
        }

        .timeline-item:nth-child(odd) {
            padding-right: 50%;
        }

        .timeline-item:nth-child(even) {
            padding-left: 50%;
        }

        .timeline-content {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            position: relative;
        }

        .timeline-content h3 {
            color: #ffd700;
            margin-bottom: 10px;
        }

        .timeline-content::before {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background: #ffd700;
            border-radius: 50%;
            top: 20px;
        }

        .timeline-item:nth-child(odd) .timeline-content::before {
            right: -10px;
            transform: translateX(50%);
        }

        .timeline-item:nth-child(even) .timeline-content::before {
            left: -10px;
            transform: translateX(-50%);
        }

        /* 毕业感言 */
        .comments-section {
            margin: 50px 0;
        }

        .speech-container {
            max-width: 800px;
            margin: 0 auto 40px;
        }

        .speech-item {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(5px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            animation: fadeIn 0.6s ease forwards;
            opacity: 0;
            transform: translateY(20px);
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .speech-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .speech-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #ffd700;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            color: #1a2a6c;
            font-weight: bold;
        }

        .speech-author {
            font-weight: bold;
            color: #ffd700;
        }

        .speech-date {
            margin-left: auto;
            font-size: 0.9rem;
            color: #888;
        }

        .speech-content {
            line-height: 1.6;
        }

        .comment-form {
            max-width: 800px;
            margin: 0 auto;
            padding: 25px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(5px);
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .comment-form h3 {
            margin-bottom: 15px;
            color: #ffd700;
        }

        .comment-form textarea {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(255, 215, 0, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: #333;
            font-size: 1rem;
            margin-bottom: 15px;
            resize: vertical;
            transition: all 0.3s ease;
        }

        .comment-form textarea:focus {
            outline: none;
            border-color: #ffd700;
            background: rgba(255, 255, 255, 0.15);
        }

        .comment-form button {
            background: #ffd700;
            color: #1a2a6c;
            border: none;
            padding: 12px 25px;
            border-radius: 30px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin-left: auto;
        }

        .comment-form button:hover {
            background: #ffdf40;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .login-prompt {
            text-align: center;
            margin-top: 15px;
            color: #888;
        }

        .login-prompt a {
            color: #ffd700;
            text-decoration: none;
            font-weight: bold;
        }

        /* 数据库状态指示器 */
        .db-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 100;
        }

        .db-status .indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
        }

        .db-status .connecting {
            background: #ffcc00;
        }

        .db-status .connected {
            background: #4CAF50;
        }

        .db-status .error {
            background: #f44336;
        }

        /* 页脚 */
        footer {
            text-align: center;
            padding: 30px;
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.7);
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            h1 {
                font-size: 2.3rem;
            }
            
            .subtitle {
                font-size: 1.3rem;
            }
            
            .class-info {
                font-size: 1.1rem;
            }
            
            .section-title {
                font-size: 1.8rem;
            }
            
            .timeline::before {
                left: 30px;
            }
            
            .timeline-item:nth-child(odd),
            .timeline-item:nth-child(even) {
                padding: 0;
                padding-left: 70px;
            }
            
            .timeline-content::before {
                left: 20px;
                transform: translateX(-50%);
            }
            
            .nav-links {
                position: fixed;
                top: 70px;
                left: 0;
                right: 0;
                background: rgba(26, 42, 108, 0.95);
                flex-direction: column;
                align-items: center;
                padding: 20px 0;
                gap: 15px;
                transform: translateY(-150%);
                transition: transform 0.4s ease;
            }
            
            .nav-links.active {
                transform: translateY(0);
            }
            
            .nav-toggle {
                display: block;
            }
            
            .roster-container {
                grid-template-columns: 1fr;
            }

            .photo-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }

            .theme-switch {
                top: 75px;
                right: 15px;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 1.8rem;
            }
            
            .subtitle {
                font-size: 1.1rem;
            }
            
            .section-title {
                font-size: 1.6rem;
            }
            
            .glass-container {
                padding: 20px 15px;
            }
            
            .photo-grid {
                grid-template-columns: 1fr;
            }
            
            .student-card {
                padding: 15px;
            }
            
            .student-avatar {
                width: 60px;
                height: 60px;
                font-size: 20px;
            }
            
            .theme-switch button span {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- 数据库状态指示器 -->
    <div class="db-status">
        <span class="indicator connecting"></span>
        <span class="status-text">连接数据库...</span>
    </div>

    <!-- 主题切换按钮 -->
    <div class="theme-switch">
        <button id="themeToggle">
            <i class="fas fa-moon"></i>
            <span>夜间模式</span>
        </button>
    </div>
    
    <!-- 顶部导航栏 -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <i class="fas fa-graduation-cap"></i>
                <span>66中2025级1班</span>
            </div>
            <div class="nav-links">
                <a href="#" class="active">首页</a>
                <a href="#gallery">照片墙</a>
                <a href="#roster">通讯录</a>
                <a href="#timeline">时光轴</a>
                <a href="#comments">毕业感言</a>
                <a href="#" id="authBtn">登录/注册</a>
            </div>
            <button class="nav-toggle" id="navToggle">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </nav>

    <!-- 主要内容 -->
    <div class="container">
        <!-- 头部区域 -->
        <header class="glass-container">
            <div class="school-logo">
                <i class="fas fa-school"></i>
            </div>
            <h1>毕业纪念册</h1>
            <div class="subtitle">青春不散场 · 梦想再起航</div>
            <div class="class-info">
                <i class="fas fa-map-marker-alt"></i> 重庆市第66中学校 · 
                <i class="fas fa-graduation-cap"></i> 2025级1班
            </div>
        </header>

        <!-- 视频区域 -->
        <section class="video-section glass-container">
            <h2 class="section-title">我们的毕业视频</h2>
            <div class="video-container">
                <video id="graduationVideo" controls poster="https://images.unsplash.com/photo-1523050854058-8df90110c9f1?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80">
                    <source src="viodio/毕业视频.mp4" type="video/mp4">
                    您的浏览器不支持视频播放。
                </video>
            </div>
        </section>

        <!-- 照片墙 -->
        <section class="gallery-section glass-container" id="gallery">
            <h2 class="section-title">班级记忆</h2>
            <div class="photo-grid">
                <div class="photo-item">
                    <img src="picture/class1.jpg" alt="开学第一天">
                    <div class="photo-caption">开学第一天</div>
                </div>
                <div class="photo-item">
                    <img src="picture/sports.jpg" alt="运动会">
                    <div class="photo-caption">运动会风采</div>
                </div>
                <div class="photo-item">
                    <img src="picture/classroom.jpg" alt="课堂学习">
                    <div class="photo-caption">课堂时光</div>
                </div>
                <div class="photo-item">
                    <img src="picture/activity.jpg" alt="课外活动">
                    <div class="photo-caption">课外活动</div>
                </div>
                <div class="photo-item">
                    <img src="picture/graduation.jpg" alt="毕业典礼">
                    <div class="photo-caption">毕业典礼</div>
                </div>
                <div class="photo-item">
                    <img src="picture/campus.jpg" alt="校园风景">
                    <div class="photo-caption">校园风景</div>
                </div>
            </div>
        </section>

        <!-- 班级通讯录 -->
        <section class="roster-section glass-container" id="roster">
            <h2 class="section-title">班级通讯录</h2>
            <div class="roster-container" id="rosterContainer">
                <!-- 学生信息通过JavaScript加载 -->
            </div>
        </section>

        <!-- 时间线 -->
        <section class="timeline-section glass-container" id="timeline">
            <h2 class="section-title">初中时光轴</h2>
            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-content">
                        <h3>2022年9月</h3>
                        <p>我们相遇在重庆市第66中学校2025级1班，开启了初中生活的新篇章。开学典礼上，我们怀着憧憬和期待，认识了新同学和新老师。</p>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-content">
                        <h3>2023年3月</h3>
                        <p>班级在春季运动会中荣获团体总分第一名！同学们在赛场上挥洒汗水，展现了团结拼搏的精神。</p>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-content">
                        <h3>2023年9月</h3>
                        <p>初二学年开始，我们举办了"青春梦想"主题班会。每位同学分享了自己的梦想和未来规划，加深了彼此的了解。</p>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-content">
                        <h3>2024年4月</h3>
                        <p>班级组织了一次难忘的春季郊游，前往南山植物园。我们在自然中学习，在欢笑中成长。</p>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-content">
                        <h3>2025年1月</h3>
                        <p>进入初三下学期，备战中考。同学们互相鼓励，共同进步，教室里充满了奋斗的气息。</p>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-content">
                        <h3>2025年6月</h3>
                        <p>毕业季来临！我们拍摄了毕业照，举办了毕业晚会，珍藏这三年的美好回忆。</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 毕业感言 -->
        <section class="comments-section glass-container" id="comments">
            <h2 class="section-title">毕业感言</h2>
            <div class="speech-container" id="speechContainer">
                <!-- 感言通过JavaScript加载 -->
            </div>
            
            <!-- 评论表单 -->
            <div class="comment-form" id="commentForm">
                <h3>分享你的毕业感言</h3>
                <textarea id="commentInput" placeholder="请输入你的毕业感言..." required></textarea>
                <button id="submitComment">发表感言</button>
                <p class="login-prompt">请先<a href="#" id="loginPrompt">登录</a>后再发表感言</p>
            </div>
        </section>

        <!-- 页脚 -->
        <footer class="glass-container">
            <p>© 2025 重庆市第66中学校2025级1班 毕业纪念网站</p>
            <p>青春不散场 · 梦想再起航</p>
            <p><i class="fas fa-heart"></i> 永远的一班 <i class="fas fa-heart"></i></p>
        </footer>
    </div>

    <!-- SQL.js-httpvfs 库 -->
    <script src="https://cdn.jsdelivr.net/npm/sql.js@1.8.0/dist/sql-wasm.js"></script>
    <script src="https://unpkg.com/sql.js-httpvfs@1.2.2/dist/sqlite.worker.js"></script>
    
    <script>
        // 初始化数据库连接
        let dbWorker = null;
        let db = null;
        
        // 更新数据库状态显示
        function updateDbStatus(status, message) {
            const statusEl = document.querySelector('.db-status');
            const indicator = statusEl.querySelector('.indicator');
            const text = statusEl.querySelector('.status-text');
            
            indicator.className = 'indicator';
            indicator.classList.add(status);
            text.textContent = message;
        }
        
        // 初始化SQL.js-httpvfs
        async function initDatabase() {
            updateDbStatus('connecting', '连接数据库...');
            
            try {
                // 创建数据库worker
                dbWorker = new Worker('https://unpkg.com/sql.js-httpvfs@1.2.2/dist/sqlite.worker.js');
                
                // 创建数据库连接
                db = await createDbWorker(
                    [
                        {
                            from: "inline",
                            config: {
                                serverMode: "full", // 文件较小，使用完整模式
                                requestChunkSize: 4096,
                                url: "/data/speeches.db" // 数据库文件路径
                            }
                        }
                    ],
                    'https://cdn.jsdelivr.net/npm/sql.js@1.8.0/dist/sql-wasm.wasm',
                    dbWorker
                );
                
                updateDbStatus('connected', '数据库已连接');
                console.log("SQLite数据库已成功加载");
                
                // 数据库连接成功后加载数据
                loadData();
                
            } catch (error) {
                console.error("数据库初始化失败:", error);
                updateDbStatus('error', '数据库连接失败');
                // 回退到本地存储
                loadLocalData();
            }
        }
        
        // 从数据库加载数据
        async function loadData() {
            try {
                // 加载学生数据
                const students = await db.query('SELECT * FROM students');
                renderStudentRoster(students);
                
                // 加载毕业感言
                const speeches = await db.query('SELECT * FROM speeches ORDER BY date DESC');
                renderSpeeches(speeches);
                
            } catch (error) {
                console.error("数据库查询失败:", error);
                updateDbStatus('error', '数据查询失败');
                // 回退到本地存储
                loadLocalData();
            }
        }
        
        // 加载本地存储数据（回退方案）
        function loadLocalData() {
            // 学生数据
            const students = JSON.parse(localStorage.getItem('classStudents')) || [];
            if (students.length > 0) {
                renderStudentRoster(students);
            }
            
            // 毕业感言
            const speeches = JSON.parse(localStorage.getItem('classSpeeches')) || [];
            if (speeches.length > 0) {
                renderSpeeches(speeches);
            }
        }
        
        // 渲染学生通讯录
        function renderStudentRoster(students) {
            const rosterContainer = document.querySelector('.roster-container');
            rosterContainer.innerHTML = '';
            
            students.forEach(student => {
                const genderIcon = student.gender === '男' ? 'mars' : 'venus';
                const genderClass = student.gender === '男' ? 'male' : 'female';
                
                const studentCard = document.createElement('div');
                studentCard.className = `student-card ${genderClass}`;
                studentCard.innerHTML = `
                    <div class="student-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="student-info">
                        <div class="student-name">${student.name}</div>
                        <div class="student-contact">
                            <i class="fas fa-phone"></i> ${student.phone}
                        </div>
                        <div class="student-contact">
                            <i class="fas fa-${genderIcon}"></i> ${student.gender}
                        </div>
                    </div>
                `;
                rosterContainer.appendChild(studentCard);
            });
        }
        
        // 渲染毕业感言
        function renderSpeeches(speeches) {
            const speechContainer = document.querySelector('.speech-container');
            speechContainer.innerHTML = '';
            
            speeches.forEach((speech, index) => {
                const initials = speech.author.substring(0, 1);
                const delay = index * 200;
                
                const speechItem = document.createElement('div');
                speechItem.className = 'speech-item';
                speechItem.style.animationDelay = `${delay}ms`;
                speechItem.innerHTML = `
                    <div class="speech-header">
                        <div class="speech-avatar">${initials}</div>
                        <div class="speech-author">${speech.author}</div>
                        <div class="speech-date">${speech.date}</div>
                    </div>
                    <div class="speech-content">
                        ${speech.content}
                    </div>
                `;
                speechContainer.appendChild(speechItem);
            });
        }
        
        // 初始化用户系统
        function initAuthSystem() {
            const authModal = document.getElementById('authModal');
            const authBtn = document.getElementById('authBtn');
            const closeAuth = document.getElementById('closeAuth');
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            const authTabs = document.querySelectorAll('.auth-tab');
            const authTitle = document.getElementById('authTitle');
            const loginPrompt = document.getElementById('loginPrompt');
            const submitComment = document.getElementById('submitComment');
            
            // 显示登录/注册模态框
            authBtn.addEventListener('click', (e) => {
                e.preventDefault();
                authModal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
            });
            
            // 关闭模态框
            closeAuth.addEventListener('click', () => {
                authModal.style.display = 'none';
                document.body.style.overflow = '';
            });
            
            // 点击模态框外部关闭
            authModal.addEventListener('click', (e) => {
                if (e.target === authModal) {
                    authModal.style.display = 'none';
                    document.body.style.overflow = '';
                }
            });
            
            // 切换登录/注册标签
            authTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // 更新活动标签
                    authTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    // 切换表单
                    if (tab.dataset.tab === 'login') {
                        loginForm.classList.remove('hidden');
                        registerForm.classList.add('hidden');
                        authTitle.textContent = '登录账号';
                    } else {
                        loginForm.classList.add('hidden');
                        registerForm.classList.remove('hidden');
                        authTitle.textContent = '注册账号';
                    }
                });
            });
            
            // 用户注册
            registerForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                const username = document.getElementById('regUsername').value;
                const email = document.getElementById('regEmail').value;
                const password = document.getElementById('regPassword').value;
                const confirm = document.getElementById('regConfirm').value;
                
                if (password !== confirm) {
                    alert('两次输入的密码不一致！');
                    return;
                }
                
                // 检查用户是否已存在
                const users = JSON.parse(localStorage.getItem('classUsers') || '[]');
                const userExists = users.some(user => user.username === username);
                
                if (userExists) {
                    alert('用户名已存在！');
                    return;
                }
                
                // 创建新用户
                const newUser = {
                    username,
                    email,
                    password,
                    joined: new Date().toISOString()
                };
                
                users.push(newUser);
                localStorage.setItem('classUsers', JSON.stringify(users));
                
                // 保存为当前用户
                localStorage.setItem('currentUser', JSON.stringify(newUser));
                
                alert('注册成功！');
                authModal.style.display = 'none';
                document.body.style.overflow = '';
                checkLoginStatus();
                registerForm.reset();
            });
            
            // 用户登录
            loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                const username = document.getElementById('loginUsername').value;
                const password = document.getElementById('loginPassword').value;
                
                const users = JSON.parse(localStorage.getItem('classUsers') || '[]');
                const user = users.find(u => u.username === username && u.password === password);
                
                if (user) {
                    // 登录成功
                    localStorage.setItem('currentUser', JSON.stringify(user));
                    alert(`欢迎回来，${username}！`);
                    authModal.style.display = 'none';
                    document.body.style.overflow = '';
                    checkLoginStatus();
                } else {
                    alert('用户名或密码错误！');
                }
                
                loginForm.reset();
            });
            
            // 登录提示
            loginPrompt.addEventListener('click', (e) => {
                e.preventDefault();
                authModal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
            });
            
            // 评论提交
            submitComment.addEventListener('click', () => {
                const commentInput = document.getElementById('commentInput');
                const comment = commentInput.value.trim();
                
                if (!comment) {
                    alert('请输入毕业感言内容');
                    return;
                }
                
                const currentUser = JSON.parse(localStorage.getItem('currentUser'));
                if (!currentUser) {
                    alert('请先登录后再发表感言');
                    authModal.style.display = 'flex';
                    return;
                }
                
                // 创建新的感言
                const newSpeech = {
                    author: currentUser.username,
                    content: comment,
                    date: new Date().toISOString().split('T')[0]
                };
                
                // 添加到感言列表
                const speeches = JSON.parse(localStorage.getItem('classSpeeches') || '[]');
                speeches.unshift(newSpeech);
                localStorage.setItem('classSpeeches', JSON.stringify(speeches));
                
                // 重新渲染
                renderSpeeches(speeches);
                
                // 清空输入框
                commentInput.value = '';
                
                alert('感言发表成功！');
            });
        }
        
        // 检查登录状态
        function checkLoginStatus() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            const authBtn = document.getElementById('authBtn');
            const loginPrompt = document.querySelector('.login-prompt');
            
            if (currentUser) {
                authBtn.textContent = currentUser.username;
                authBtn.href = 'javascript:void(0);';
                
                // 显示评论表单
                if (loginPrompt) loginPrompt.style.display = 'none';
                
                // 添加退出功能
                authBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (confirm('确定要退出登录吗？')) {
                        localStorage.removeItem('currentUser');
                        authBtn.textContent = '登录/注册';
                        checkLoginStatus();
                    }
                });
            } else {
                authBtn.textContent = '登录/注册';
                authBtn.href = '#';
                
                // 隐藏评论表单
                if (loginPrompt) loginPrompt.style.display = 'block';
            }
        }
        
        // 初始化主题切换
        function initThemeToggle() {
            const themeToggle = document.getElementById('themeToggle');
            const icon = themeToggle.querySelector('i');
            const text = themeToggle.querySelector('span');
            
            // 应用保存的主题
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
                icon.className = 'fas fa-sun';
                text.textContent = '日间模式';
            }
            
            // 主题切换
            themeToggle.addEventListener('click', () => {
                const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                
                document.documentElement.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                
                if (newTheme === 'dark') {
                    icon.className = 'fas fa-sun';
                    text.textContent = '日间模式';
                } else {
                    icon.className = 'fas fa-moon';
                    text.textContent = '夜间模式';
                }
            });
        }
        
        // 初始化导航菜单
        function initNavigation() {
            const navToggle = document.getElementById('navToggle');
            const navLinks = document.querySelector('.nav-links');
            
            navToggle.addEventListener('click', () => {
                navLinks.classList.toggle('active');
            });
            
            // 平滑滚动
            document.querySelectorAll('.nav-links a').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    if (this.getAttribute('href').startsWith('#')) {
                        e.preventDefault();
                        
                        const targetId = this.getAttribute('href');
                        const targetElement = document.querySelector(targetId);
                        
                        if (targetElement) {
                            window.scrollTo({
                                top: targetElement.offsetTop - 80,
                                behavior: 'smooth'
                            });
                            
                            // 关闭移动端菜单
                            navLinks.classList.remove('active');
                        }
                    }
                });
            });
        }
        
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', () => {
            initDatabase();
            initAuthSystem();
            initThemeToggle();
            initNavigation();
            checkLoginStatus();
        });
    </script>
</body>
</html>